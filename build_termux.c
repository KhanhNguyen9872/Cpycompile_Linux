#if 0
	KhanhNguyen9872
	https://github.com/KhanhNguyen9872
	https://fb.me/khanh10a1
	
#endif

static  char data [] = 
#define      xecc_z	15
#define      xecc	((&data[3]))
	"\003\203\026\175\155\150\162\324\070\002\317\167\162\043\137\145"
	"\261\177\271\275\146"
#define      chk1_z	22
#define      chk1	((&data[24]))
	"\230\310\110\206\202\272\206\065\116\261\066\325\357\040\367\173"
	"\104\047\100\155\376\226\132\066\216\026\165\063\121\211"
#define      msg1_z	65
#define      msg1	((&data[59]))
	"\131\016\057\321\374\063\070\364\336\127\275\053\107\004\041\216"
	"\256\042\157\371\065\270\327\004\003\071\161\003\364\213\053\163"
	"\251\307\377\161\256\274\151\072\146\037\234\203\035\300\341\035"
	"\337\123\203\050\276\264\102\256\371\327\272\015\017\234\064\027"
	"\147\146\117\162\375\225\006\013\153\226\035"
#define      chk2_z	19
#define      chk2	((&data[129]))
	"\006\123\136\316\202\007\352\124\005\103\255\337\267\013\270\022"
	"\061\226\276\106\070\036\155\336\350"
#define      lsto_z	1
#define      lsto	((&data[151]))
	"\122"
#define      msg2_z	19
#define      msg2	((&data[154]))
	"\335\336\011\062\153\260\026\274\041\047\276\123\325\265\377\261"
	"\355\362\021\171\342"
#define      rlax_z	1
#define      rlax	((&data[173]))
	"\304"
#define      text_z	6691
#define      text	((&data[669]))
	"\012\035\143\076\126\130\325\163\110\157\025\117\303\163\275\241"
	"\134\037\030\015\311\245\065\247\204\345\231\334\300\345\102\313"
	"\002\245\012\131\375\337\314\106\117\342\226\022\126\124\264\262"
	"\163\314\300\075\162\365\344\366\333\176\322\234\144\025\147\147"
	"\273\162\300\271\121\215\000\240\157\227\263\305\353\147\170\137"
	"\063\070\234\246\056\201\234\012\000\157\247\144\205\016\313\101"
	"\201\214\372\322\031\373\163\211\222\046\116\176\215\306\335\301"
	"\377\171\147\056\373\004\070\373\164\337\137\371\356\053\072\157"
	"\267\065\102\321\061\265\132\303\334\250\101\152\157\036\053\157"
	"\230\223\235\223\230\326\216\014\266\356\005\245\031\100\025\320"
	"\166\127\241\247\015\373\153\351\244\254\124\024\313\200\203\143"
	"\023\041\367\254\367\205\270\256\164\276\123\215\376\150\136\165"
	"\300\000\034\315\374\210\267\240\064\013\265\000\214\071\144\240"
	"\132\133\114\122\341\004\000\125\302\124\342\301\274\101\067\174"
	"\101\123\112\075\333\001\336\020\015\223\021\231\314\165\072\047"
	"\320\206\171\262\212\172\007\115\316\352\017\212\053\106\007\154"
	"\231\121\251\165\123\207\206\140\033\227\372\347\014\064\017\335"
	"\273\210\217\105\002\227\223\320\201\242\133\255\350\142\031\202"
	"\264\303\370\007\113\176\150\146\026\143\116\043\227\135\001\122"
	"\346\221\230\350\050\054\271\252\316\025\127\266\170\161\071\054"
	"\064\061\064\200\260\234\346\307\377\065\352\227\223\353\352\171"
	"\175\202\142\245\257\034\120\175\061\247\064\251\031\155\326\116"
	"\236\012\316\117\247\265\026\246\353\001\076\176\354\050\367\152"
	"\253\131\017\132\166\137\330\247\007\014\121\040\171\047\157\030"
	"\062\075\150\331\363\176\200\336\177\276\134\154\347\124\326\223"
	"\256\346\356\044\106\306\313\116\322\034\157\114\104\336\145\166"
	"\034\315\120\017\114\320\355\314\217\112\070\167\236\017\012\114"
	"\366\370\160\075\277\074\213\221\131\372\336\235\331\103\024\365"
	"\021\144\004\135\065\362\051\305\074\142\075\332\162\110\047\151"
	"\101\230\246\000\324\061\222\055\054\160\313\005\263\337\372\305"
	"\104\376\042\172\361\114\100\055\257\175\010\042\305\060\213\337"
	"\204\220\231\251\101\247\135\344\156\313\135\176\100\011\233\013"
	"\371\263\174\072\102\246\305\265\140\354\203\325\043\044\131\315"
	"\311\115\377\040\250\306\250\161\050\330\153\075\130\322\004\206"
	"\164\033\043\213\374\246\176\011\052\221\033\077\132\343\003\014"
	"\233\074\131\006\051\267\272\157\200\106\160\043\251\055\130\142"
	"\100\066\225\031\023\107\066\320\063\064\121\061\034\227\121\235"
	"\337\350\327\322\160\120\040\021\113\220\262\247\272\023\161\002"
	"\215\362\236\140\070\035\224\002\347\016\057\133\016\134\271\025"
	"\315\332\152\151\246\036\047\160\346\347\142\354\110\132\063\106"
	"\273\004\222\156\162\216\323\374\065\176\332\212\000\312\035\210"
	"\067\206\334\256\315\107\204\067\235\345\121\057\271\040\004\351"
	"\117\264\016\336\224\267\067\144\246\171\160\261\216\163\224\117"
	"\342\243\231\125\227\034\034\123\221\052\360\102\135\111\340\207"
	"\321\350\347\320\273\122\057\133\122\202\170\017\367\015\014\107"
	"\055\350\343\114\247\233\050\055\346\272\372\032\326\023\304\261"
	"\042\072\137\124\301\344\331\101\132\323\257\345\351\010\263\236"
	"\111\072\141\035\032\222\052\074\366\353\336\343\213\110\047\311"
	"\327\037\311\374\250\247\056\205\265\021\177\143\221\363\013\341"
	"\007\146\117\346\125\010\164\207\167\116\275\050\110\161\310\000"
	"\261\017\013\371\372\014\235\272\320\061\122\166\046\263\123\106"
	"\000\073\171\122\335\267\253\265\056\315\372\053\011\071\175\123"
	"\270\272\053\136\001\367\334\207\326\012\143\202\174\267\300\167"
	"\020\360\267\075\237\047\257\217\044\065\125\171\306\056\055\031"
	"\171\232\076\032\347\214\260\236\300\332\170\161\246\134\156\032"
	"\221\316\232\265\351\366\245\345\362\026\072\335\222\230\131\333"
	"\360\153\226\354\147\137\056\310\220\205\344\133\152\302\013\274"
	"\004\176\036\312\210\334\342\362\163\377\350\240\035\344\321\103"
	"\215\342\305\031\114\266\272\017\146\266\225\303\033\025\125\224"
	"\202\354\000\113\377\161\203\217\110\163\335\247\155\050\110\173"
	"\207\205\304\352\331\071\322\350\315\164\303\370\341\243\356\250"
	"\027\022\372\365\276\370\077\341\034\300\340\245\132\052\063\340"
	"\171\176\002\073\324\135\374\321\304\171\315\330\364\221\135\271"
	"\367\053\033\317\173\002\166\360\000\162\217\005\306\163\354\163"
	"\164\204\247\222\164\335\032\271\004\172\302\333\045\310\320\161"
	"\043\013\257\006\072\140\220\302\312\043\351\274\010\133\266\345"
	"\206\133\142\214\015\374\100\125\147\215\237\224\130\031\323\243"
	"\350\160\363\061\135\330\072\137\201\005\117\201\052\121\152\046"
	"\052\162\230\215\107\275\067\357\267\014\225\041\034\131\115\265"
	"\335\122\361\216\135\001\135\311\335\244\207\275\102\352\074\036"
	"\317\042\001\042\352\105\007\340\024\245\260\160\243\204\367\313"
	"\320\140\301\357\041\055\367\201\244\325\121\170\267\065\131\034"
	"\062\072\152\360\230\047\023\336\374\057\054\011\366\361\004\074"
	"\331\072\251\052\027\373\210\006\004\116\013\121\277\017\162\013"
	"\140\262\115\063\330\107\324\321\130\301\323\101\157\340\061\145"
	"\062\325\133\353\046\316\047\045\074\316\200\151\021\070\075\335"
	"\062\050\034\143\066\134\217\117\331\223\301\371\361\123\005\233"
	"\120\105\122\234\253\100\357\361\060\074\130\324\366\340\124\012"
	"\362\057\004\362\057\121\131\110\267\177\366\206\037\053\213\147"
	"\127\251\150\237\070\061\352\354\256\374\066\213\144\062\063\304"
	"\261\131\155\277\273\036\301\050\062\106\253\063\331\277\222\372"
	"\367\371\066\342\304\241\005\322\142\232\013\073\341\310\114\272"
	"\066\063\014\021\177\310\225\011\370\144\066\153\011\116\121\356"
	"\342\056\327\040\334\352\271\024\355\143\117\001\073\151\344\374"
	"\330\222\325\320\205\100\063\267\052\226\045\075\056\064\256\361"
	"\032\000\362\304\243\252\113\166\242\031\236\024\241\155\024\012"
	"\015\043\251\164\005\353\125\132\010\241\162\330\377\352\042\142"
	"\315\252\207\260\145\124\107\056\301\253\153\334\331\133\361\135"
	"\300\304\365\203\306\320\240\061\227\201\075\020\232\304\364\375"
	"\224\371\144\133\006\254\162\224\011\056\331\113\315\107\143\341"
	"\323\277\205\356\336\261\174\046\005\175\330\173\342\052\351\234"
	"\234\050\354\053\063\275\246\321\205\025\332\016\242\346\207\215"
	"\373\124\262\017\031\067\032\375\200\266\346\134\230\105\275\016"
	"\371\070\176\264\150\205\035\061\322\131\235\310\252\256\340\156"
	"\232\146\207\202\116\151\226\041\166\047\077\241\151\105\272\303"
	"\230\363\302\031\042\154\077\110\372\131\142\377\020\303\114\160"
	"\257\006\131\170\254\023\303\145\125\214\071\336\174\066\055\166"
	"\106\226\233\254\106\221\050\105\373\042\331\131\007\061\132\233"
	"\165\176\067\063\261\105\122\200\065\041\034\372\305\057\300\211"
	"\312\364\170\043\226\335\236\365\164\256\177\132\367\200\213\242"
	"\345\213\330\373\147\311\202\115\212\311\306\363\236\214\134\102"
	"\144\116\373\165\144\013\275\136\100\370\216\117\211\333\041\165"
	"\104\301\151\150\010\167\223\065\375\131\170\354\366\033\221\171"
	"\301\156\364\207\164\152\147\166\346\227\132\006\346\311\242\346"
	"\303\147\053\100\014\365\045\053\025\342\264\110\227\251\043\164"
	"\100\257\076\166\171\141\165\133\004\073\201\065\317\321\213\003"
	"\023\134\011\363\004\023\124\152\042\057\166\313\115\152\245\076"
	"\303\020\044\036\301\032\154\004\130\252\072\120\003\204\262\350"
	"\234\320\265\036\352\104\031\012\333\012\201\375\032\054\325\032"
	"\367\031\046\054\373\220\272\036\005\126\330\001\171\312\302\020"
	"\217\054\371\041\205\127\326\354\272\132\355\152\154\124\053\043"
	"\155\032\155\263\201\205\332\056\277\342\143\125\161\043\250\216"
	"\053\111\045\316\225\131\305\273\057\166\221\325\032\063\270\345"
	"\023\273\165\247\341\311\144\277\220\236\226\224\330\200\142\330"
	"\135\207\041\202\032\120\012\013\126\254\354\102\350\322\070\353"
	"\321\261\026\016\272\245\354\236\121\157\161\333\101\257\136\300"
	"\151\124\044\012\364\112\065\126\341\167\152\264\020\200\043\345"
	"\314\301\072\043\173\340\246\211\207\046\030\232\155\326\267\066"
	"\174\204\102\230\003\201\320\335\321\226\223\145\162\240\320\245"
	"\041\071\222\104\376\122\161\351\151\230\271\056\113\147\100\265"
	"\353\163\276\152\143\341\342\347\160\225\175\014\052\107\051\110"
	"\313\340\275\037\275\266\203\010\107\263\365\061\155\353\164\226"
	"\372\316\307\213\375\155\352\261\364\152\227\276\371\222\356\147"
	"\233\005\057\211\230\277\004\301\112\333\045\216\341\136\122\121"
	"\017\237\213\301\132\207\142\165\056\175\127\120\246\223\333\341"
	"\233\201\261\223\316\323\022\314\262\275\357\004\240\113\240\360"
	"\363\205\203\151\326\354\362\210\002\047\303\227\344\114\130\312"
	"\102\176\014\005\141\312\072\161\313\264\252\221\112\267\274\162"
	"\016\111\211\230\223\052\005\371\137\100\147\162\272\211\003\260"
	"\303\156\372\233\324\072\066\103\257\150\044\054\110\060\316\157"
	"\166\167\363\004\043\336\124\345\322\065\236\341\323\111\000\326"
	"\241\344\200\242\317\170\336\004\072\164\012\124\045\172\055\016"
	"\171\153\014\041\003\072\061\257\175\351\176\270\014\211\265\020"
	"\353\163\211\243\235\254\344\112\116\271\304\143\345\061\052\064"
	"\372\035\202\121\065\244\117\072\235\166\362\157\070\014\111\176"
	"\036\226\133\336\320\101\140\330\175\373\170\156\247\132\243\142"
	"\302\122\237\120\166\320\063\367\130\307\303\265\036\034\303\247"
	"\147\011\000\307\304\012\071\144\110\217\053\371\326\011\112\206"
	"\170\333\047\352\237\165\155\333\124\071\125\167\331\135\012\265"
	"\303\243\072\300\227\077\342\375\224\040\122\250\130\163\064\350"
	"\132\223\260\006\321\112\051\303\154\014\017\043\037\140\032\340"
	"\022\004\073\371\005\120\262\121\231\320\264\314\266\236\165\106"
	"\105\362\063\167\245\154\211\173\252\125\034\270\077\370\314\267"
	"\025\171\002\333\271\253\252\253\007\273\220\165\036\256\012\225"
	"\366\006\366\167\114\225\266\030\044\222\075\375\076\134\325\163"
	"\035\167\225\355\011\254\242\024\307\312\157\123\110\133\256\154"
	"\345\050\164\330\106\032\014\126\243\103\004\207\022\321\001\377"
	"\122\224\027\024\314\040\137\101\033\224\072\327\350\221\160\004"
	"\254\250\125\144\013\111\212\165\065\040\353\135\105\254\177\146"
	"\345\340\264\304\272\210\371\040\210\047\017\163\324\114\221\070"
	"\200\042\050\324\052\073\357\126\277\262\040\106\301\334\201\257"
	"\151\007\274\006\207\362\164\014\345\367\223\034\331\060\133\366"
	"\171\057\264\047\355\117\332\074\074\260\367\232\211\377\375\312"
	"\371\370\073\242\321\233\335\217\035\117\162\034\354\271\375\071"
	"\377\243\110\220\367\216\004\243\250\163\026\003\156\145\372\020"
	"\241\025\270\114\250\054\237\014\004\102\376\075\133\040\216\306"
	"\222\077\216\243\027\150\364\247\112\230\130\165\105\210\355\015"
	"\045\017\023\135\123\114\064\052\346\235\335\166\151\207\113\003"
	"\276\101\127\235\077\073\175\134\112\125\071\016\224\004\104\031"
	"\323\056\204\310\053\241\166\316\363\216\024\154\353\013\204\337"
	"\233\356\137\045\227\261\033\320\304\031\261\357\153\376\301\263"
	"\333\226\012\047\276\021\275\336\303\357\063\151\123\214\123\075"
	"\157\150\327\125\162\075\271\067\137\314\122\335\061\205\157\323"
	"\167\374\000\225\231\071\066\170\164\122\103\205\121\147\227\030"
	"\351\214\266\256\157\312\205\135\276\356\152\101\072\171\375\161"
	"\331\153\012\374\261\071\106\321\004\357\137\213\015\276\040\211"
	"\031\141\150\021\000\363\273\331\150\142\271\357\274\171\015\332"
	"\330\337\331\030\241\133\100\141\276\267\246\357\345\230\167\367"
	"\330\067\260\225\152\335\302\357\151\132\236\023\343\166\054\131"
	"\173\014\147\355\202\170\047\001\205\155\262\104\052\143\017\151"
	"\324\344\036\304\214\034\317\121\055\102\270\121\105\037\151\133"
	"\300\046\176\235\346\001\123\334\006\302\372\264\221\122\140\247"
	"\221\346\250\231\074\161\177\204\305\131\316\221\264\074\242\244"
	"\161\142\051\277\152\020\221\225\016\226\322\132\132\171\110\212"
	"\321\274\156\357\170\036\251\237\277\037\177\273\171\351\233\057"
	"\342\356\264\241\060\226\030\247\215\100\010\323\075\303\110\163"
	"\163\255\014\105\111\303\330\123\371\041\006\225\101\256\354\112"
	"\204\057\331\272\153\375\264\044\020\141\226\210\341\000\271\133"
	"\260\110\045\124\115\332\345\017\333\335\371\164\073\105\050\122"
	"\165\374\012\043\116\041\076\171\171\201\045\022\005\345\304\337"
	"\175\051\330\120\134\232\205\021\251\120\122\347\256\233\354\103"
	"\255\163\377\334\371\372\055\307\257\210\122\354\307\215\034\201"
	"\016\213\374\271\030\221\230\136\145\365\240\142\057\006\272\127"
	"\064\003\226\350\220\363\120\343\227\023\270\044\312\305\007\260"
	"\225\115\324\242\346\064\267\163\164\117\166\366\365\043\253\350"
	"\063\152\010\172\105\367\162\314\176\027\217\174\147\140\124\305"
	"\103\311\151\335\071\031\101\131\036\134\124\213\344\272\012\102"
	"\313\345\142\000\270\064\230\071\364\062\221\261\155\243\041\322"
	"\231\376\127\016\225\076\164\144\306\104\002\237\162\354\140\356"
	"\126\006\317\014\366\360\240\044\125\171\037\237\036\103\273\322"
	"\216\010\322\155\310\256\011\107\333\171\151\357\327\006\207\114"
	"\034\051\311\241\000\105\377\372\222\014\241\016\144\300\025\370"
	"\264\154\071\343\117\335\245\310\366\110\120\170\332\001\126\156"
	"\371\145\201\236\257\361\103\362\320\043\333\371\266\152\067\357"
	"\321\336\111\376\175\056\043\055\032\252\044\325\061\173\372\001"
	"\117\313\100\354\041\174\145\225\155\226\204\162\337\240\036\223"
	"\047\163\313\343\044\203\310\371\244\011\210\252\276\000\261\353"
	"\375\311\233\204\271\070\316\236\071\246\253\017\375\030\113\214"
	"\370\020\067\140\261\123\052\076\206\365\244\236\272\043\014\343"
	"\225\052\166\034\320\152\321\075\012\064\157\256\070\124\023\273"
	"\341\326\030\367\067\112\201\171\322\356\002\217\054\011\261\122"
	"\071\047\055\347\037\135\161\103\233\266\335\201\265\140\101\135"
	"\337\245\243\362\316\104\027\332\135\025\213\353\124\177\165\165"
	"\113\360\126\231\165\074\074\364\213\133\276\140\376\123\172\052"
	"\175\120\125\157\256\136\256\154\327\042\021\342\023\352\113\375"
	"\325\341\357\123\107\134\024\375\045\125\226\050\065\137\112\126"
	"\250\034\045\165\130\244\361\065\024\372\330\116\152\176\110\065"
	"\105\203\357\357\120\250\003\025\254\240\076\255\267\001\246\304"
	"\113\356\171\243\357\007\170\301\117\346\201\006\123\123\171\367"
	"\041\255\212\311\004\224\234\340\305\046\251\346\336\175\003\154"
	"\136\352\337\000\130\356\104\351\324\170\053\126\256\132\003\250"
	"\364\005\143\043\333\230\164\230\201\137\134\170\253\107\265\105"
	"\110\176\003\161\276\255\360\347\257\340\263\376\115\313\047\070"
	"\137\050\216\311\274\235\210\074\157\072\331\270\334\103\041\001"
	"\261\376\207\155\105\221\310\112\206\250\214\110\203\230\245\202"
	"\073\331\075\306\215\232\023\031\233\365\141\322\046\076\370\073"
	"\101\170\230\130\221\274\053\005\375\343\265\073\236\362\273\306"
	"\160\262\144\100\051\011\013\173\234\177\113\261\247\314\277\015"
	"\230\243\112\147\263\272\166\343\206\156\133\143\322\307\374\054"
	"\162\340\321\335\334\016\157\021\227\277\360\124\225\066\371\135"
	"\347\253\006\277\066\151\267\304\374\261\170\212\105\340\200\241"
	"\347\316\170\070\360\072\301\005\365\036\205\032\234\245\035\154"
	"\333\003\361\303\013\156\220\002\357\373\054\131\215\172\031\103"
	"\344\310\124\107\353\164\002\177\144\055\117\134\356\132\137\263"
	"\025\341\026\207\161\244\173\324\165\041\362\136\030\023\063\271"
	"\071\244\255\324\005\157\271\220\153\320\212\374\357\153\315\034"
	"\227\133\347\074\166\040\153\335\145\350\122\351\251\067\152\156"
	"\031\120\320\176\165\003\262\330\113\003\004\026\327\376\346\366"
	"\241\034\232\131\103\367\363\163\301\125\215\076\175\362\074\361"
	"\074\074\266\106\341\065\021\167\106\377\245\332\173\041\206\200"
	"\155\036\076\066\266\227\236\225\224\321\371\261\077\053\377\222"
	"\027\177\223\112\226\367\314\061\235\166\362\044\066\161\351\046"
	"\173\121\302\273\350\300\157\041\252\252\032\157\316\042\140\237"
	"\336\052\253\110\245\174\074\371\273\200\164\004\061\345\102\343"
	"\263\144\343\116\271\234\225\011\317\125\114\301\374\076\322\074"
	"\103\033\054\210\354\300\250\105\265\051\064\263\225\144\073\143"
	"\003\275\011\213\275\040\123\162\356\374\011\161\077\151\026\323"
	"\224\132\322\232\140\134\150\014\106\132\325\315\143\124\043\172"
	"\116\163\306\122\337\037\001\304\305\340\173\066\227\225\146\056"
	"\332\102\131\057\300\025\107\261\036\160\175\155\275\206\056\221"
	"\031\032\177\010\020\112\033\001\342\377\176\044\272\117\004\062"
	"\023\255\064\035\212\046\001\171\106\314\233\031\266\106\022\050"
	"\273\203\361\325\371\031\156\223\276\354\302\267\335\204\216\333"
	"\254\176\006\214\312\362\013\102\103\305\045\263\054\103\135\071"
	"\007\132\232\323\242\346\026\030\207\160\151\321\024\015\110\145"
	"\024\327\106\211\101\110\226\020\306\136\023\022\274\047\301\242"
	"\007\133\315\333\175\274\335\124\350\376\153\273\341\176\104\063"
	"\252\111\015\027\203\217\323\112\034\101\141\311\022\217\075\160"
	"\247\047\273\241\151\150\222\311\057\173\161\143\373\137\045\362"
	"\331\003\257\273\220\340\063\003\261\055\230\165\332\065\053\136"
	"\137\274\216\171\360\140\356\357\163\152\105\071\047\147\013\352"
	"\107\260\107\266\015\350\004\355\316\020\250\265\064\273\326\326"
	"\325\111\127\066\256\207\372\174\160\060\334\001\077\314\341\355"
	"\027\211\021\370\276\350\266\267\234\346\007\363\340\036\220\330"
	"\264\333\264\056\316\165\227\365\067\237\345\373\315\040\063\145"
	"\047\064\246\104\132\041\346\011\167\122\133\115\315\271\242\337"
	"\223\246\130\052\113\036\032\023\040\107\042\232\152\166\152\147"
	"\122\045\232\115\201\122\252\112\010\036\270\025\121\312\230\076"
	"\352\164\131\062\337\074\312\356\234\334\060\036\140\174\223\312"
	"\116\260\260\057\145\170\204\272\333\011\072\311\006\070\371\147"
	"\125\311\277\007\342\252\200\177\225\076\064\170\053\326\222\227"
	"\257\246\140\066\177\034\073\071\051\342\131\016\131\371\255\343"
	"\112\026\275\211\127\254\377\053\040\217\030\240\151\035\355\217"
	"\227\070\027\015\060\321\201\064\271\123\271\352\006\266\123\367"
	"\262\352\256\050\071\066\365\010\306\157\003\043\167\016\052\311"
	"\323\151\072\061\007\374\365\060\040\024\222\044\045\303\352\114"
	"\250\164\004\325\204\106\301\102\342\011\134\352\220\116\301\023"
	"\154\026\335\355\113\004\250\062\042\127\120\271\344\332\271\225"
	"\065\137\021\035\124\217\154\363\117\035\336\053\274\351\065\020"
	"\025\174\354\337\111\120\170\156\270\073\042\043\203\242\113\117"
	"\023\055\114\007\334\076\174\050\314\345\136\225\263\330\170\350"
	"\346\142\075\330\232\360\126\363\011\126\131\377\165\354\200\311"
	"\266\375\211\247\142\026\222\371\370\032\370\111\117\341\257\054"
	"\231\100\271\301\262\071\261\075\274\216\332\347\146\036\023\135"
	"\033\206\047\357\036\222\056\361\021\100\052\225\312\121\030\363"
	"\314\014\307\164\051\062\337\327\063\256\320\266\342\277\323\061"
	"\370\263\012\145\346\343\010\261\174\207\131\121\304\142\271\302"
	"\076\046\356\152\075\327\305\273\141\250\135\073\170\065\060\006"
	"\236\147\216\202\153\116\225\066\312\201\134\053\353\114\316\000"
	"\062\014\266\022\271\211\325\057\276\261\307\130\222\023\046\224"
	"\301\076\350\214\002\041\221\252\034\335\001\113\055\305\011\330"
	"\314\004\317\064\216\172\103\006\350\337\376\257\241\303\060\210"
	"\314\363\004\152\113\155\144\032\040\250\302\163\066\173\315\106"
	"\350\332\042\202\172\264\020\255\202\303\177\053\304\102\256\003"
	"\173\315\166\127\254\014\063\361\147\100\263\345\243\203\206\142"
	"\045\316\257\254\361\022\144\261\014\116\276\034\145\330\103\376"
	"\254\326\250\264\115\214\315\060\246\203\043\131\045\221\100\037"
	"\227\072\215\263\021\163\127\002\002\202\153\231\375\127\243\264"
	"\355\156\276\002\341\037\367\357\301\031\240\103\203\036\110\154"
	"\142\352\260\261\234\022\115\116\251\122\275\337\153\253\056\206"
	"\372\350\103\325\267\016\000\103\306\073\014\377\050\322\334\117"
	"\131\037\025\177\352\347\277\151\336\044\121\141\274\242\150\162"
	"\345\370\000\152\102\165\326\006\354\315\125\207\063\143\234\116"
	"\245\163\371\111\044\054\315\040\044\274\053\110\320\122\165\054"
	"\340\322\330\253\141\152\276\133\155\337\221\061\273\216\376\012"
	"\324\064\341\376\304\334\346\275\076\000\365\266\350\067\162\220"
	"\354\236\344\147\137\043\014\063\355\212\165\216\306\033\017\144"
	"\211\102\265\004\302\225\271\135\367\024\362\250\017\040\351\333"
	"\300\054\227\234\071\037\167\316\110\302\132\012\120\247\325\145"
	"\113\015\231\272\145\120\041\022\206\066\114\335\353\335\372\150"
	"\211\126\353\002\365\054\307\277\115\060\246\356\265\273\243\077"
	"\330\313\266\042\111\004\222\004\162\104\162\037\214\344\230\121"
	"\332\320\320\044\006\064\161\047\364\230\006\365\141\107\173\072"
	"\055\172\142\135\150\217\163\245\340\135\233\165\051\232\300\260"
	"\240\353\263\131\070\313\045\016\214\212\236\322\163\265\314\235"
	"\373\157\367\117\366\136\026\236\242\254\165\103\031\161\276\274"
	"\004\073\245\315\000\143\203\312\031\126\234\342\154\126\317\001"
	"\324\261\207\024\175\134\271\132\073\354\132\026\146\033\276\025"
	"\242\353\375\332\124\263\325\161\227\132\241\167\220\222\031\372"
	"\002\144\034\165\144\354\145\011\137\343\066\225\362\053\375\353"
	"\367\100\355\042\302\132\216\040\101\316\066\153\132\351\127\177"
	"\163\326\160\335\054\006\220\027\065\013\043\235\126\001\125\151"
	"\007\254\121\025\122\241\150\057\034\254\176\150\256\152\067\224"
	"\122\334\100\257\234\350\334\114\200\363\162\035\204\054\200\313"
	"\175\271\134\275\170\272\363\113\270\310\360\324\077\217\065\026"
	"\307\133\332\241\352\155\147\151\162\105\124\347\052\315\143\254"
	"\353\220\353\047\115\267\254\361\132\341\112\343\237\022\207\351"
	"\137\304\263\003\007\261\337\064\065\141\030\056\345\305\135\053"
	"\167\206\334\227\206\045\213\222\235\132\262\226\233\224\064\336"
	"\335\057\371\314\111\142\004\345\216\367\075\046\075\351\234\115"
	"\076\346\251\226\100\117\135\336\172\370\305\030\103\210\017\215"
	"\132\120\131\124\127\172\247\045\166\063\135\077\273\245\311\134"
	"\366\011\015\021\044\376\077\255\242\036\072\334\017\067\165\130"
	"\132\156\152\064\140\143\324\100\354\023\373\021\112\216\100\233"
	"\235\171\056\003\216\045\257\253\141\301\146\025\210\053\366\306"
	"\121\146\216\316\044\371\245\152\160\176\013\025\220\243\243\153"
	"\040\363\337\056\327\344\227\227\212\351\127\115\103\127\326\027"
	"\110\112\036\064\336\130\256\003\323\221\226\160\156\215\307\256"
	"\101\335\326\334\227\115\152\361\224\217\221\111\245\101\357\107"
	"\010\376\345\363\213\064\231\327\014\077\027\176\225\313\254\107"
	"\266\237\214\252\054\277\312\223\117\062\357\156\237\203\144\002"
	"\246\327\343\372\012\262\160\323\273\243\316\212\062\364\220\257"
	"\164\070\243\160\274\144\106\056\023\324\316\016\147\042\276\001"
	"\253\171\023\067\160\251\017\041\146\242\046\210\261\115\105\174"
	"\366\105\070\207\326\042\055\144\123\256\002\106\164\203\202\002"
	"\346\046\163\141\137\001\353\037\146\264\357\255\052\234\105\122"
	"\273\276\311\173\372\244\375\255\172\035\353\344\235\305\231\024"
	"\122\010\323\014\306\107\362\070\063\057\234\274\175\171\002\253"
	"\327\336\362\162\171\060\174\262\335\145\026\332\331\041\231\336"
	"\111\154\062\347\326\313\325\163\035\335\144\351\221\245\306\270"
	"\064\254\112\114\150\252\230\127\274\307\301\135\117\210\052\217"
	"\123\352\312\147\232\311\307\001\014\070\314\271\070\127\017\334"
	"\341\346\300\027\244\252\271\266\177\376\365\203\004\042\133\216"
	"\127\223\204\015\375\135\271\171\343\020\117\361\274\214\162\345"
	"\146\062\045\304\377\211\355\073\202\312\051\277\074\113\011\306"
	"\032\060\023\315\230\004\325\066\145\200\126\121\156\224\274\015"
	"\213\127\272\272\123\265\041\277\365\071\276\322\126\304\044\300"
	"\155\056\034\204\007\006\252\340\236\304\011\006\171\127\171\314"
	"\074\153\277\144\026\127\341\355\354\246\213\115\300\215\217\357"
	"\201\237\261\151\156\165\315\347\027\233\226\345\230\056\271\326"
	"\113\301\351\122\216\173\377\042\007\333\260\064\017\057\333\060"
	"\147\356\302\240\365\207\337\104\267\034\172\377\022\002\344\375"
	"\274\271\054\004\301\337\244\030\056\232\273\144\227\136\055\363"
	"\104\363\337\300\217\160\301\236\131\256\355\122\143\037\117\260"
	"\170\323\127\351\001\272\377\000\215\077\200\144\043\117\275\314"
	"\300\306\127\164\125\056\313\003\016\334\227\355\373\000\023\117"
	"\305\360\070\162\013\207\203\023\163\014\266\335\062\343\271\004"
	"\261\335\355\276\115\001\270\310\100\215\046\033\020\134\360\307"
	"\066\012\355\227\124\201\242\075\363\201\045\030\332\162\357\046"
	"\366\266\276\031\122\362\236\072\023\077\073\227\370\370\123\031"
	"\011\174\012\332\333\235\123\157\040\160\032\110\014\112\061\372"
	"\001\165\125\353\002\302\165\061\150\272\013\006\177\366\003\261"
	"\215\107\242\243\142\051\256\041\175\077\060\053\065\354\026\332"
	"\344\302\307\371\201\032\111\165\124\243\314\002\236\027\176\364"
	"\154\320\154\054\170\225\326\346\264\044\242\151\361\213\244\100"
	"\247\025\076\031\150\172\140\005\005\071\024\100\301\300\305\370"
	"\206\040\130\332\103\102\074\007\076\253\241\266\172\025\172\260"
	"\043\010\070\303\146\100\162\371\022\172\355\004\016\177\052\245"
	"\011\337\316\370\137\342\014\272\141\261\304\036\323\156\075\136"
	"\322\313\076\152\123\075\072\246\337\265\125\122\251\154\063\305"
	"\003\042\264\146\237\106\051\254\146\376\160\360\260\023\004\014"
	"\214\335\064\047\133\124\264\274\102\272\320\061\261\377\263\036"
	"\314\033\163\276\020\277\257\325\204\105\137\025\145\270\345\065"
	"\132\142\300\227\151\161\224\170\201\007\101\015\102\221\362\073"
	"\177\361\315\251\357\300\040\206\215\373\004\143\140\326\260\354"
	"\040\167\041\311\174\204\077\320\321\124\173\013\145\027\335\270"
	"\245\310\170\173\167\275\215\330\041\316\353\062\033\371\051\123"
	"\331\046\374\010\220\142\344\274\237\362\315\004\046\366\027\154"
	"\366\036\121\252\175\210\221\256\146\334\160\006\157\354\125\075"
	"\021\014\042\153\204\134\267\074\312\136\302\152\347\234\163\067"
	"\232\355\017\206\131\207\206\224\147\261\346\265\330\256\207\164"
	"\171\235\360\314\135\161\007\331\154\113\353\051\137\250\326\233"
	"\135\113\360\234\164\220\067\064\054\065\147\167\064\072\221\326"
	"\276\164\041\357\212\241\171\174\064\365\133\212\204\257\254\171"
	"\233\003\075\100\116\322\063\110\212\243\205\350\323\044\012\056"
	"\273\062\220\246\004\360\012\012\143\364\005\372\206\104\110\103"
	"\231\350\163\276\073\025\124\062\152\105\236\114\065\364\152\040"
	"\355\201\277\114\201\264\371\211\015\031\242\203\115\050\107\211"
	"\340\073\047\166\345\362\023\150\104\045\043\115\201\174\240\075"
	"\371\243\101\257\122\333\337\302\347\254\377\117\020\275\306\265"
	"\346\070\300\141\032\036\031\225\210\314\354\073\171\231\323\270"
	"\252\351\155\242\322\330\154\046\021\065\206\334\224\366\355\045"
	"\010\364\153\312\201\226\175\313\045\014\264\130\147\306\077\302"
	"\237\270\317\111\362\360\217\163\222\155\152\205\204\032\321\030"
	"\357\062\272\010\047\107\066\061\147\320\062\136\373\011\347\030"
	"\232\374\076\317\052\354\062\050\013\357\337\023\211\074\327\301"
	"\321\215\326\311\224\174\275\277\034\256\307\046\177\062\260\210"
	"\157\330\171\260\146\025\267\265\154\244\222\054\244\047\251\231"
	"\053\167\264\251\150\050\046\217\340\367\361\150\344\226\067\274"
	"\131\315\007\061\266\371\304\057\060\047\120\003\072\034\345\202"
	"\122\121\353\227\300\234\125\035\211\302\156\021\303\322\034\344"
	"\251\065\147\155\321\117\244\270\025\250\027\322\036\164\055\154"
	"\160\073\242\236\176\172\033\371\322\231\302\242\121\145\036\076"
	"\235\345\172\044\156\261\250\240\014\254\154\310\045\004\041\071"
	"\215\251\024\154\363\232\330\030\371\113\230\151\010\033\321\014"
	"\244\125\133\066\066\205\267\326\052\005\225\336\034\022\343\157"
	"\265\222\143\323\002\163\310\355\242\363\350\174\253\115\052\107"
	"\354\162\145\016\066\111\315\370\241\162\321\276\003\367\027\044"
	"\144\364\371\000\172\146\274\105\144\127\343\046\104\070\356\260"
	"\367\341\272\216\124\071\101\047\263\036\040\243\052\251\142\001"
	"\044\124\201\216\367\114\351\075\207\260\144\233\303\071\002\015"
	"\304\142\110\027\312\243\171\374\335\156\237\335\322\346\104\307"
	"\010\044\331\155\162\337\061\370\037\126\323\267\346\310\160\072"
	"\164\051\337\235\011\200\025\135\020\235\370\234\053\044\013\062"
	"\037\073\135\177\371\133\177\233\366\350\335\027\222\363\363\113"
	"\054\323\276\247\301\364\015\265\013\254\116\164\361\336\354\326"
	"\062\031\242\203\046\211\107\172\042\022\371\121\240\034\210\265"
	"\302\004\035\257\324\230\105\112\303\130\005\311\323\363\240\131"
	"\277\000\112\171\230\074\156\205\236\043\056\346\151\371\143\331"
	"\054\260\322\141\021\253\160\340\057\004\226\314\231\256\044\034"
	"\137\172\117\115\302\310\125\036\275\120\363\202\052\322\256\044"
	"\156\074\075\020\035\261\155\127\320\243\363\216\152\140\314\235"
	"\170\053\050\161\203\274\362\206\062\171\327\115\352\062\341\356"
	"\115\373\233\005\034\022\355\140\327\045\131\026\357\104\240\326"
	"\036\044\172\364\172\265\164\076\031\063\033\243\322\121\242\217"
	"\013\216\204\160\144\010\132\242\040\222\016\210\343\340\255\013"
	"\116\263\250\112\206\116\333\160\376\356\312\167\232\175\072\122"
	"\256\223\007\105\102\132\225\241\270\162\331\372\125\102\060\020"
	"\363\105\002\373\052\200\350\250\053\352\267\330\147\114\305\005"
	"\361\223\213\171\064\012\003\322\110\353\017\070\136\040\232\206"
	"\041\225\264\316\324\326\137\272\244\011\207\245\323\120\362\304"
	"\373\113\101\300\077\144\214\147\375\047\112\250\236\062\031\307"
	"\116\341\156\021\211\347\021\347\076\122\135\116\140\024\210\360"
	"\021\113\011\306\072\077\044\161\233\302\262\130\033\262\043\264"
	"\373\144\377\163\165\314\030\167\317\376\343\120\141\327\077\364"
	"\164\322\060\066\135\035\225\110\107\251\335\355\313\173\074\210"
	"\001\000\046\313\117\113\123\255\331\243\270\254\074\271\060\210"
	"\220\163\275\077\341\166\120\102\173\150\136\376\363\370\133\107"
	"\173\037\255\163\355\150\067\074\330\314\364\111\223\325\047\163"
	"\237\363\201\116\203\100\040\237\005\145\302\267\271\360\224\211"
	"\122\147\135\342\311\073\331\307\166\351\070\332\126\371\155\142"
	"\324\062\310\033\321\272\051\317\272\175\003\223\004\172\101\304"
	"\101\117\161\323\030\005\346\226\177\053\050\366\244\363\322\164"
	"\072\220\336\171\246\234\260\312\021\356\031\267\237\276\017\270"
	"\320\374\055\111\070\334\144\171\177\123\121\357\322\377\044\233"
	"\364\052\047\026\203\044\141\233\064\257\352\037\324\172\354\355"
	"\240\364\362\055\064\372\142\303\126\302\176\361\154\125\135\054"
	"\377\232\020\312\314\043\376\237\275\371\244\074\061\027\054\025"
	"\167\135\321\103\167\132\146\112\377\115\345\235\002\117\176\112"
	"\374\134\006\310\061\006\234\142\230\312\216\011\226\223\275\166"
	"\216\202\272\215\245\065\176\361\165\254\241\362\264\303\270\345"
	"\116\276\255\177\305\112\342\136\025\160\147\253\004\044\041\222"
	"\246\334\040\113\021\236\075\207\112\336\172\377\241\062\344\357"
	"\361\221\157\266\334\121\024\361\301\173\234\306\240\276\131\106"
	"\232\171\222\254\030\317\063\142\255\256\142\117\340\106\076\321"
	"\330\255\210\264\377\234\246\301\030\102\207\270\000\341\377\233"
	"\132\221\107\162\140\173\325\016\051\067\135\011\176\234\333\127"
	"\112\143\014\111\000\262\013\031\365\222\321\365\163\320\221\316"
	"\141\330\101\302\124\027\321\175\117\057\207\315\314\143\045\027"
	"\306\061\141\307\343\154\340\330\376\262\316\162\203\137\101\345"
	"\070\203\247\214\232\171\012\351\250\221\267\164\364\334\214\273"
	"\015\355\203\361\131\144\312\130\026\230\313\231\370\015\176\061"
	"\220\046\276\053\237\310\025\110\132\314\275\116\251\111\012\267"
	"\066\215\250\220\361\162\350\010\013\264\241\004\301\040\066\122"
	"\106\364\175\346\275\222\056\027\137\353\146\010\065\160\277\153"
	"\376\150\373\360\333\344\371\347\231\233\353\132\273\041\254\002"
	"\026\052\351\323\275\030\352\034\003\121\044\071\302\344\244\300"
	"\115\240\261\050\205\253\017\036\106\373\171\002\035\046\004\063"
	"\120\356\006\015\006\361\052\012\102\116\103\004\063\350\305\200"
	"\210\167\251\016\042\271\054\150\264\246\152\321\314\157\005\034"
	"\135\013\052\144\375\124\156\077\243\261\103\327\232\011\127\043"
	"\200\001\061\242\272\136\013\157\004\165\100\320\345\106\355\102"
	"\121\027\246\117\154\025\216\017\307\322\346\141\333\076\204\134"
	"\077\265\377\372\023\012\151\030\177\252\350\144\360\326\247\102"
	"\356\116\221\132\143\037\152\052\362\120\213\316\217\020\052\317"
	"\305\051\311\331\063\062\362\263\335\332\030\315\261\277\017\237"
	"\016\240\371\161\300\143\234\262\264\050\200\103\070\253\022\376"
	"\324\334\327\010\016\312\273\354\244\324\271\126\223\311\365\241"
	"\152\356\023\052\122\260\335\006\330\136\111\020\012\134\016\336"
	"\070\346\347\107\260\243\063\125\167\355\253\013\266\241\255\040"
	"\217\300\113\342\160\050\350\111\207\062\132\221\216\151\160\307"
	"\120\127\016\000\373\102\126\162\057\002\175\345\244\052\005\063"
	"\353\120\026\134\171\376\245\000\060\377\222\277\150\002\206\270"
	"\132\225\271\125\327\020\307\006\023\105\353\267\157\361\353\132"
	"\102\001\267\274\377\134\275\060\134\117\360\305\122\166\175\254"
	"\014\067\001\343\110\310\351\133\015\325\023\175\307\376\330\012"
	"\000\217\306\000\354\204\060\110\323\041\015\045\227\213\321\243"
	"\303\323\207\013\233\161\147\251\106\173\046\016\171\377\030\172"
	"\216\337\172\173\143\253\304\067\314\322\135\144\135\057\007\041"
	"\002\217\055\236\000\225\110\107\020\157\125\212\156\156\004\375"
	"\115\176\170\261\052\074\351\366\016\106\132\154\166\142\216\170"
#define      pswd_z	256
#define      pswd	((&data[8077]))
	"\362\120\137\071\141\316\216\353\074\375\357\072\113\156\262\374"
	"\231\357\346\217\376\055\352\152\243\115\370\034\077\264\063\061"
	"\005\222\152\146\140\371\121\235\366\101\330\101\260\212\076\305"
	"\001\151\062\125\040\031\051\220\354\345\372\224\352\214\147\145"
	"\103\200\061\154\001\041\127\315\175\134\303\306\365\331\213\366"
	"\103\275\114\144\327\165\364\303\133\356\130\106\173\277\253\276"
	"\100\334\052\102\376\202\020\174\336\324\103\323\256\316\312\361"
	"\214\026\125\144\214\111\050\347\070\200\055\263\100\331\162\201"
	"\266\234\303\265\037\323\061\375\247\164\320\125\103\233\107\320"
	"\261\234\064\076\346\134\046\036\335\124\322\036\055\104\237\343"
	"\341\143\231\000\067\313\376\337\077\317\064\203\152\174\124\034"
	"\030\210\132\376\345\201\035\303\325\360\342\003\065\202\347\026"
	"\345\200\027\034\113\025\373\213\344\060\017\117\254\143\153\305"
	"\353\306\304\321\107\342\225\035\322\167\040\007\371\007\036\337"
	"\207\065\373\322\113\367\136\060\050\155\177\325\320\353\233\274"
	"\261\137\215\371\102\042\026\024\231\066\034\223\075\073\162\305"
	"\160\156\227\274\145\366\355\216\143\155\143\063\130\376\357\012"
	"\136\174\003\240\237\032\265\071\120\322\314\216\015\076\123\176"
	"\255\353\072\023\341\050\241\104\225\005\170\355\004\147\370\111"
	"\172\044\330\170"
#define      inlo_z	3
#define      inlo	((&data[8338]))
	"\340\213\335"
#define      date_z	1
#define      date	((&data[8341]))
	"\127"
#define      shll_z	41
#define      shll	((&data[8345]))
	"\104\200\225\015\120\060\357\320\365\227\251\306\330\343\215\045"
	"\313\135\176\054\054\073\161\171\115\336\160\142\313\107\300\040"
	"\377\270\277\332\063\156\164\273\055\335\341\307\326\353\373\067"
	"\344\114"
#define      tst2_z	19
#define      tst2	((&data[8396]))
	"\255\033\076\070\141\315\300\367\363\000\004\075\042\257\363\202"
	"\074\276\006\131\371\364\265\132\207"
#define      opts_z	1
#define      opts	((&data[8417]))
	"\104"
#define      tst1_z	22
#define      tst1	((&data[8422]))
	"\016\304\064\352\047\322\203\216\222\061\126\127\257\327\112\212"
	"\310\113\242\035\363\200\113\206\225\133"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}

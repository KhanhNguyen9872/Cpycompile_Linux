#if 0
	KhanhNguyen9872
	https://github.com/KhanhNguyen9872
	https://fb.me/khanh10a1
	
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\044"
#define      msg1_z	65
#define      msg1	((&data[10]))
	"\324\050\012\365\025\060\045\111\320\163\342\372\201\322\056\031"
	"\022\212\306\232\160\073\272\111\253\067\115\157\310\262\335\325"
	"\143\257\122\277\245\363\174\010\005\232\006\355\074\245\245\005"
	"\036\317\067\131\017\222\135\352\163\207\034\100\375\322\126\047"
	"\274\235\313\063\004\164\170\320\320\026\003\012\253\153\134\063"
	"\207"
#define      msg2_z	19
#define      msg2	((&data[86]))
	"\152\127\035\066\062\110\003\375\363\357\345\371\324\047\065\026"
	"\066\310\103\365\024\174\361"
#define      pswd_z	256
#define      pswd	((&data[132]))
	"\227\252\267\037\032\214\110\044\201\136\125\247\247\045\253\261"
	"\321\027\016\004\236\263\341\272\036\070\330\277\364\074\146\355"
	"\303\143\132\042\124\056\341\225\370\275\131\266\327\014\153\122"
	"\141\136\033\367\172\113\001\176\236\001\076\223\076\244\200\002"
	"\010\333\044\134\012\005\362\002\302\114\270\232\130\043\354\271"
	"\202\010\261\375\124\263\173\363\265\271\206\363\136\007\365\147"
	"\342\031\303\354\037\266\356\342\002\247\174\132\313\151\024\115"
	"\162\306\112\306\172\306\271\057\200\100\042\336\107\030\105\052"
	"\062\011\026\121\277\005\063\301\254\260\034\170\032\061\305\214"
	"\370\020\123\162\327\014\241\127\114\304\065\224\335\173\276\017"
	"\204\325\141\103\333\225\005\207\106\042\000\140\123\305\355\113"
	"\326\100\276\255\115\137\005\232\043\072\056\000\266\355\020\073"
	"\302\162\177\235\007\204\045\116\246\045\256\372\353\234\106\302"
	"\334\004\160\052\143\165\304\207\260\363\210\146\340\231\241\243"
	"\013\040\101\023\245\147\141\114\215\020\106\171\254\215\073\211"
	"\221\254\264\365\041\170\175\321\154\006\070\115\237\332\360\253"
	"\372\062\276\240\231\040\354\046\060\063\237\335\300\333\147\122"
	"\207\033\110\251\224\305\172\001\313\263\116\124\102\103\366\332"
	"\355\255\371\010\072\102\055\273\240\203\143\107\250\016\371\172"
	"\045\007\177\304\272\140\177\331\230\127\055\332\233\043\264\211"
	"\321\256\221\013"
#define      chk2_z	19
#define      chk2	((&data[432]))
	"\221\102\053\021\225\324\077\361\044\161\166\311\337\134\026\035"
	"\315\171\246\000\066\342\331\353\072"
#define      text_z	6474
#define      text	((&data[1099]))
	"\332\345\044\225\105\244\156\335\373\233\270\227\277\154\040\221"
	"\033\262\235\014\161\144\236\264\220\167\240\312\112\006\052\044"
	"\353\117\271\060\363\047\016\357\303\306\206\203\063\247\024\116"
	"\131\261\133\313\026\371\200\247\161\040\161\274\046\234\340\021"
	"\354\232\102\337\302\120\317\206\027\126\011\112\375\036\231\126"
	"\320\365\042\346\357\242\215\140\302\377\034\351\233\375\373\210"
	"\227\076\147\132\216\067\340\246\215\352\360\212\010\212\341\330"
	"\177\003\277\156\246\115\317\150\114\354\122\350\352\115\160\202"
	"\213\330\334\032\017\274\300\235\247\261\047\257\074\011\210\273"
	"\015\107\052\263\224\372\034\341\347\156\311\321\274\071\123\107"
	"\022\057\142\042\354\042\277\224\324\347\103\020\360\314\314\375"
	"\023\367\261\250\362\315\211\331\073\123\252\367\215\376\077\237"
	"\056\241\301\033\304\201\257\230\150\363\251\131\277\166\127\323"
	"\155\010\174\140\325\005\071\021\131\344\010\346\342\110\205\021"
	"\351\107\054\255\310\333\106\061\317\360\212\217\146\342\142\324"
	"\352\336\064\300\344\156\321\075\122\332\044\065\042\251\106\013"
	"\360\162\271\271\116\000\352\035\361\165\254\127\127\017\054\102"
	"\356\141\002\323\317\323\020\041\255\064\127\320\336\235\333\317"
	"\017\225\211\135\226\163\173\207\351\050\337\101\067\013\203\045"
	"\155\205\370\074\131\011\136\006\076\265\326\035\122\262\354\142"
	"\110\165\300\336\351\073\145\323\143\105\024\233\120\227\300\276"
	"\035\271\372\166\302\131\175\001\016\123\036\141\006\012\304\117"
	"\200\204\055\151\300\223\075\044\331\121\277\051\351\177\350\006"
	"\070\342\174\373\074\371\374\112\115\032\254\124\045\160\243\245"
	"\365\321\017\265\145\114\331\076\236\231\150\207\031\120\215\122"
	"\063\012\115\157\004\112\272\121\145\147\246\212\327\111\060\315"
	"\033\077\202\200\214\134\277\053\365\047\262\016\170\100\140\253"
	"\112\256\032\116\370\325\240\135\074\106\350\024\220\030\341\253"
	"\130\144\054\344\301\353\017\267\023\302\306\213\002\047\066\115"
	"\325\121\234\316\046\075\054\142\203\024\167\023\054\130\277\205"
	"\274\353\151\176\327\171\065\352\074\373\165\077\042\253\215\367"
	"\375\051\306\043\146\362\206\352\007\375\376\064\126\275\271\023"
	"\251\043\221\200\235\306\152\331\301\337\031\343\213\246\333\210"
	"\320\241\254\067\224\062\041\233\060\040\317\206\335\210\231\207"
	"\253\053\007\111\361\161\042\262\121\073\226\334\342\162\145\262"
	"\023\021\351\250\104\013\103\164\053\023\373\011\233\225\220\107"
	"\300\227\220\261\011\263\144\132\357\373\067\321\155\234\203\201"
	"\255\154\051\361\170\154\146\243\200\141\254\034\367\074\143\267"
	"\324\364\150\335\250\315\070\227\310\157\150\065\013\353\266\270"
	"\130\340\252\321\115\020\164\315\162\041\351\151\135\115\040\062"
	"\101\211\020\352\126\270\232\320\273\175\376\036\170\131\122\324"
	"\076\035\030\003\104\364\133\160\162\313\236\113\232\107\017\265"
	"\022\377\246\061\113\143\010\250\017\221\231\105\033\024\131\165"
	"\233\127\137\127\152\143\277\007\213\343\375\015\240\041\342\304"
	"\137\106\157\140\311\270\256\211\264\336\354\204\352\275\215\220"
	"\153\304\176\037\310\262\271\071\125\325\213\303\076\036\200\232"
	"\134\044\207\227\154\126\347\043\100\020\207\307\320\240\015\266"
	"\060\036\153\376\001\132\325\345\064\161\252\314\372\213\337\063"
	"\332\302\225\163\247\376\077\254\326\256\171\360\267\333\036\051"
	"\135\047\104\306\064\053\101\132\056\270\075\170\073\262\114\224"
	"\036\116\127\146\104\320\023\271\257\267\363\327\342\202\363\304"
	"\241\105\217\324\157\274\163\053\267\370\274\175\227\222\220\046"
	"\214\343\001\273\101\047\226\211\203\161\224\205\331\045\120\223"
	"\157\354\272\112\151\171\023\103\377\227\315\057\102\243\172\223"
	"\302\127\300\033\356\333\370\351\256\356\320\356\202\340\132\214"
	"\067\323\354\334\075\045\234\276\201\035\237\354\023\334\365\365"
	"\130\253\147\170\110\044\200\062\345\216\050\033\324\330\072\134"
	"\012\165\076\151\272\153\221\137\154\167\351\023\150\357\224\107"
	"\141\311\047\211\235\124\002\030\162\106\002\332\026\111\175\114"
	"\070\135\143\372\374\305\113\314\324\015\251\357\225\222\272\242"
	"\367\142\027\160\067\221\207\110\374\102\201\244\070\260\200\107"
	"\270\361\101\125\004\173\045\305\365\164\207\270\255\241\323\026"
	"\157\117\334\161\237\001\074\003\002\355\317\241\364\162\354\155"
	"\145\107\114\044\073\242\323\147\107\023\074\246\320\343\076\314"
	"\323\355\011\056\372\177\156\004\134\252\143\034\340\231\273\053"
	"\166\212\202\372\062\365\060\262\304\223\217\155\075\106\152\022"
	"\127\043\237\071\061\346\366\053\332\154\135\120\276\105\005\223"
	"\035\176\361\131\344\164\037\027\324\163\340\256\066\201\253\200"
	"\160\106\201\057\253\067\220\052\120\306\014\007\234\270\216\023"
	"\177\137\323\252\013\212\056\235\133\366\370\036\307\203\167\152"
	"\251\322\274\361\260\076\051\246\027\233\374\060\126\032\014\064"
	"\322\367\231\256\132\112\310\012\004\340\311\076\250\321\177\254"
	"\031\214\026\315\225\323\062\211\114\061\321\266\111\217\007\070"
	"\011\117\265\366\153\354\352\176\376\034\144\266\247\123\375\217"
	"\144\346\142\366\320\241\331\140\106\132\216\274\212\305\057\265"
	"\213\303\116\126\242\331\112\277\261\171\125\151\364\223\100\240"
	"\111\321\354\025\240\206\002\330\174\345\045\153\037\222\003\115"
	"\170\254\147\175\233\275\142\305\326\306\320\074\243\171\064\116"
	"\276\375\327\152\322\277\245\020\325\313\204\315\114\230\055\031"
	"\273\372\104\222\137\232\133\031\051\110\371\214\322\033\160\272"
	"\206\242\107\174\022\327\373\177\373\257\222\144\065\332\315\341"
	"\065\362\105\007\031\275\222\247\251\336\212\141\260\312\240\363"
	"\031\156\114\240\112\136\363\160\003\042\276\176\163\302\313\223"
	"\371\202\134\350\223\045\261\070\321\057\213\265\320\242\367\071"
	"\254\065\063\132\300\065\166\334\031\237\206\212\123\331\112\327"
	"\305\315\231\074\303\051\350\032\073\013\347\312\367\012\032\176"
	"\257\047\377\233\344\015\060\013\173\132\371\073\364\256\301\333"
	"\266\177\134\247\041\207\001\104\363\230\071\251\066\252\025\017"
	"\146\042\352\052\154\324\104\306\342\016\171\002\302\035\235\124"
	"\223\234\361\045\362\022\253\043\064\116\147\123\005\205\100\171"
	"\367\323\264\230\117\310\014\145\110\105\020\254\371\312\364\305"
	"\062\330\313\241\312\176\332\172\376\366\243\212\211\364\111\067"
	"\337\007\353\023\212\360\250\235\227\162\236\231\225\325\365\263"
	"\052\203\034\062\171\201\074\215\175\056\166\132\136\077\226\263"
	"\271\041\312\070\014\333\342\174\115\033\213\164\223\317\352\157"
	"\072\070\231\363\177\303\125\310\127\011\042\055\331\031\363\263"
	"\335\357\353\160\063\174\205\101\153\154\116\161\062\151\155\371"
	"\133\345\200\321\360\210\234\157\031\162\023\303\007\017\254\112"
	"\165\137\003\175\202\024\050\045\241\126\331\373\154\164\047\230"
	"\163\252\321\124\327\354\341\155\230\240\143\254\256\016\317\024"
	"\012\246\067\135\305\016\320\160\071\062\256\360\376\274\372\107"
	"\335\033\147\013\220\342\104\070\226\371\266\036\356\170\302\135"
	"\046\136\327\176\176\066\120\073\020\245\341\000\163\342\112\117"
	"\001\145\243\330\372\234\034\325\156\340\057\075\251\227\242\343"
	"\107\050\037\021\371\234\007\057\122\324\072\210\336\031\033\004"
	"\140\166\201\306\153\132\116\363\033\315\121\300\045\130\121\335"
	"\122\341\362\236\203\046\147\011\102\213\065\015\207\117\251\050"
	"\202\073\243\211\000\244\377\003\044\037\062\327\373\177\125\003"
	"\144\334\250\206\304\077\046\030\111\017\237\313\150\245\354\146"
	"\356\247\334\305\050\302\166\334\304\107\204\273\053\312\372\150"
	"\343\224\205\042\142\051\106\025\036\220\112\022\211\313\103\146"
	"\045\311\072\073\323\006\242\170\252\100\203\364\160\043\250\305"
	"\046\363\152\230\221\324\222\000\326\013\265\237\175\030\057\111"
	"\065\130\374\070\120\361\357\015\176\256\322\343\134\267\011\004"
	"\161\277\034\171\117\176\165\204\070\350\104\131\215\234\054\004"
	"\044\044\124\252\101\160\130\036\104\176\267\216\127\176\265\224"
	"\255\074\376\211\312\201\353\170\122\270\132\165\071\160\363\256"
	"\212\172\101\154\017\220\105\015\200\251\113\130\222\230\052\365"
	"\060\335\172\067\124\302\313\102\212\022\321\353\354\005\240\104"
	"\307\336\037\227\201\064\171\216\355\361\104\145\115\255\145\256"
	"\316\052\237\157\210\373\232\305\175\024\317\207\364\121\327\237"
	"\316\061\336\233\161\156\041\001\366\326\111\161\066\200\210\351"
	"\335\020\330\110\310\042\134\316\151\342\373\136\063\023\364\044"
	"\204\274\233\106\307\134\032\102\371\174\051\316\070\016\005\130"
	"\363\015\355\325\120\371\206\026\072\120\266\063\362\144\256\375"
	"\176\130\151\161\031\106\334\216\215\020\361\125\345\146\044\154"
	"\070\002\306\332\370\175\160\337\117\216\030\104\364\310\145\013"
	"\161\173\206\206\213\044\102\310\365\064\353\336\313\152\221\272"
	"\115\256\302\163\351\054\250\376\375\310\022\201\054\024\016\010"
	"\375\010\276\301\304\114\264\216\137\206\166\202\160\252\342\326"
	"\106\130\110\337\341\377\172\123\177\143\326\106\073\072\125\367"
	"\260\317\036\121\150\364\260\255\234\345\021\150\303\271\175\212"
	"\035\056\223\127\342\335\236\077\005\307\302\353\347\330\315\123"
	"\224\306\100\234\247\371\145\004\027\106\332\003\313\372\245\323"
	"\241\211\122\036\371\263\275\253\167\215\020\140\071\007\332\226"
	"\334\261\031\341\316\315\017\022\163\127\012\324\125\270\024\262"
	"\071\143\023\067\260\306\034\254\267\307\237\021\152\015\027\033"
	"\005\173\117\352\017\021\201\144\200\323\144\171\014\362\300\077"
	"\103\002\044\327\257\275\205\150\201\163\212\014\150\237\301\002"
	"\215\173\353\107\265\370\372\317\327\336\277\165\120\112\371\176"
	"\246\264\333\346\362\000\172\321\233\017\036\162\222\260\074\345"
	"\015\327\030\010\306\210\217\205\360\212\117\170\246\000\163\034"
	"\315\232\272\270\047\243\102\031\314\303\330\046\025\036\331\106"
	"\000\342\023\367\317\322\115\377\047\261\021\130\356\037\050\372"
	"\275\225\014\021\037\211\357\367\372\137\115\276\163\006\117\207"
	"\063\227\031\075\014\034\345\357\152\171\356\210\102\343\121\370"
	"\373\300\367\005\152\074\300\362\110\012\026\113\161\121\104\361"
	"\216\262\050\167\007\244\116\222\052\305\041\052\366\066\201\010"
	"\205\041\212\045\310\161\064\067\066\002\074\353\210\107\275\361"
	"\044\061\115\314\161\316\234\350\133\017\151\377\253\146\236\144"
	"\226\072\122\016\165\132\131\170\170\376\264\164\300\167\204\121"
	"\067\216\361\370\174\017\277\074\307\241\336\326\166\057\227\042"
	"\341\145\365\264\015\001\003\153\222\377\110\377\157\310\330\150"
	"\106\334\003\324\215\360\152\311\260\372\210\120\243\273\012\143"
	"\167\045\034\257\175\171\324\143\215\077\343\113\323\206\301\265"
	"\112\272\065\251\351\003\314\066\170\264\276\324\276\112\142\350"
	"\064\112\014\213\113\140\114\367\030\361\077\244\271\161\016\052"
	"\304\111\234\131\006\006\156\100\046\314\236\244\065\177\301\112"
	"\265\203\035\360\144\307\207\031\016\360\002\031\255\160\072\335"
	"\036\334\364\035\254\045\000\121\265\303\333\350\067\245\153\266"
	"\015\350\257\224\056\001\341\242\323\015\350\021\047\165\257\266"
	"\170\377\020\171\230\132\135\007\131\045\033\273\116\157\116\017"
	"\016\260\166\173\362\212\074\117\331\126\004\216\101\126\126\214"
	"\276\245\247\301\171\075\030\167\143\036\263\017\022\315\144\345"
	"\006\071\060\042\362\365\201\245\173\377\045\072\302\371\217\254"
	"\001\247\257\152\165\101\151\005\140\073\316\345\211\377\103\110"
	"\265\151\243\375\002\116\126\142\107\344\172\237\265\256\354\345"
	"\321\115\251\057\310\143\352\233\132\056\245\252\070\011\215\216"
	"\324\367\156\355\112\351\140\365\107\374\100\013\317\034\365\136"
	"\161\252\241\311\037\322\207\313\264\077\272\336\145\256\061\364"
	"\255\171\163\352\046\066\043\146\272\260\144\155\301\203\111\076"
	"\352\231\132\116\026\012\340\162\362\074\011\232\017\237\072\332"
	"\221\207\346\362\157\146\135\024\047\376\335\166\176\132\223\110"
	"\074\224\264\260\331\016\050\122\314\262\301\200\200\225\323\223"
	"\216\371\071\172\156\344\207\171\126\317\022\046\374\111\376\202"
	"\106\053\222\376\252\330\023\163\002\364\143\033\053\025\020\277"
	"\000\123\065\061\271\227\370\102\022\120\236\334\277\352\167\227"
	"\311\064\146\111\353\171\307\145\231\127\207\251\375\203\076\333"
	"\357\310\272\166\144\315\023\256\171\337\361\331\173\352\077\025"
	"\002\373\156\212\224\064\215\346\140\224\264\007\262\326\304\272"
	"\116\126\037\257\237\170\337\170\071\343\314\135\112\330\150\220"
	"\311\245\333\137\055\034\226\107\053\112\265\220\300\072\354\214"
	"\245\325\233\310\301\244\106\021\010\375\255\075\355\240\036\305"
	"\336\166\134\220\203\023\106\202\045\234\361\365\263\317\264\142"
	"\365\140\340\002\345\111\305\325\316\102\260\202\266\166\073\262"
	"\341\027\121\000\274\262\054\257\306\032\036\245\160\132\120\331"
	"\224\277\066\213\375\362\274\324\076\272\036\005\055\100\377\037"
	"\112\275\235\357\355\246\236\316\352\306\212\036\143\245\033\373"
	"\113\015\245\117\114\034\112\332\222\146\307\043\307\031\216\361"
	"\047\166\175\336\203\036\360\032\006\151\317\174\340\275\111\377"
	"\022\235\334\375\223\137\266\377\227\344\352\031\015\060\205\137"
	"\256\362\065\017\173\143\213\237\232\166\055\136\224\016\230\300"
	"\303\352\102\305\010\213\316\115\322\232\000\076\300\131\375\027"
	"\040\344\316\334\364\241\253\337\064\024\132\253\246\112\226\231"
	"\045\060\012\234\146\250\067\102\036\374\272\220\367\124\250\345"
	"\226\354\261\062\072\127\077\250\015\114\147\216\363\131\164\301"
	"\005\020\366\170\053\324\026\177\244\277\025\206\113\222\304\237"
	"\212\277\265\230\100\273\024\230\000\377\030\175\070\271\043\137"
	"\253\053\015\135\347\366\140\345\231\106\264\307\272\103\340\313"
	"\065\160\152\224\161\116\115\074\236\316\374\333\243\270\062\043"
	"\305\260\146\201\111\317\152\354\373\124\306\235\154\150\017\112"
	"\072\172\147\216\232\031\247\031\311\346\271\260\002\357\246\115"
	"\222\056\143\242\217\254\070\245\161\370\104\013\204\323\372\020"
	"\340\024\124\106\117\274\150\337\262\007\320\317\375\222\343\163"
	"\037\104\162\046\154\274\270\237\224\355\033\353\362\157\350\150"
	"\344\210\140\225\274\233\261\257\304\343\131\043\220\150\000\004"
	"\020\143\331\177\356\166\225\254\304\334\167\117\256\100\354\207"
	"\100\172\052\031\050\355\356\331\116\033\364\344\270\067\377\205"
	"\210\000\200\207\213\132\054\341\312\000\336\317\031\250\051\054"
	"\321\126\002\050\144\272\010\117\240\361\047\305\112\041\331\110"
	"\101\017\025\047\130\063\345\315\210\057\005\371\125\051\223\260"
	"\071\131\161\074\144\312\202\344\170\330\222\334\272\124\377\353"
	"\230\206\334\036\277\335\105\017\033\142\366\016\123\302\250\360"
	"\322\327\113\262\276\135\011\350\111\163\215\101\371\075\170\143"
	"\175\151\364\224\235\311\351\161\221\214\375\335\250\364\361\333"
	"\125\063\205\216\056\360\106\212\306\214\311\337\112\100\145\225"
	"\170\265\333\310\005\053\243\327\361\156\312\325\257\052\204\331"
	"\374\063\201\130\260\266\270\033\045\334\204\011\312\223\166\272"
	"\203\055\331\301\003\145\166\015\257\346\004\102\064\022\336\102"
	"\014\137\075\257\365\177\035\004\351\245\277\336\264\155\327\211"
	"\311\360\100\022\340\076\037\146\125\030\303\337\353\004\273\323"
	"\123\101\070\132\242\022\341\045\232\367\375\313\122\176\156\245"
	"\106\313\230\067\112\123\042\150\200\065\140\013\177\152\156\171"
	"\020\234\134\216\062\246\033\367\073\241\102\351\063\275\372\364"
	"\201\233\165\263\272\234\355\316\010\142\371\153\337\032\170\306"
	"\323\104\271\047\265\132\146\310\343\042\055\022\011\377\301\275"
	"\242\321\311\211\340\133\254\227\014\005\016\347\050\333\044\126"
	"\225\363\220\323\061\377\156\226\370\001\211\354\263\242\015\227"
	"\075\373\334\131\157\226\172\234\277\335\012\315\052\015\244\220"
	"\173\203\252\002\020\334\163\245\035\260\340\343\354\035\126\011"
	"\235\011\215\312\000\001\361\173\215\371\007\163\102\072\243\360"
	"\023\362\243\306\005\334\143\077\122\116\121\020\024\375\262\264"
	"\160\047\377\247\313\075\200\142\110\250\057\121\117\107\205\311"
	"\004\044\316\200\377\371\234\161\360\321\117\335\267\110\326\114"
	"\061\336\040\317\320\014\211\356\265\277\222\347\365\013\173\216"
	"\070\204\104\157\077\020\322\162\206\056\045\372\020\027\176\303"
	"\177\175\055\324\137\156\176\315\235\042\114\344\225\320\312\106"
	"\302\272\362\100\145\016\055\311\325\106\111\015\030\371\374\341"
	"\214\165\057\334\364\025\354\035\050\264\255\012\026\327\314\066"
	"\047\056\104\070\120\254\022\010\115\174\334\141\244\265\311\277"
	"\140\012\140\072\037\200\011\025\117\147\116\264\311\240\131\256"
	"\074\221\277\007\251\303\047\045\307\371\174\302\335\363\265\131"
	"\135\053\074\166\026\255\116\215\001\325\246\330\026\020\061\173"
	"\330\301\203\234\253\025\045\262\123\011\045\374\207\103\055\302"
	"\160\036\237\374\045\353\051\015\157\022\110\010\356\147\167\222"
	"\306\142\132\211\112\207\351\226\002\200\374\001\066\257\201\314"
	"\235\315\065\062\013\237\301\364\272\326\023\250\315\167\133\043"
	"\226\350\317\030\036\310\324\077\013\053\316\062\111\110\274\313"
	"\054\302\202\143\310\153\177\211\367\320\000\110\134\030\274\265"
	"\135\054\131\143\152\362\205\251\117\151\101\047\303\212\353\263"
	"\135\067\134\162\251\104\021\227\101\105\032\301\131\131\256\163"
	"\157\271\211\056\307\145\041\274\043\161\313\045\100\224\105\142"
	"\216\257\016\236\373\323\147\121\140\274\107\121\126\336\372\362"
	"\261\061\044\224\164\061\045\222\142\077\007\375\055\235\041\022"
	"\304\056\106\063\213\347\225\111\230\304\254\043\317\103\001\006"
	"\022\132\005\227\012\202\126\213\176\026\026\343\164\152\205\044"
	"\252\024\330\231\352\057\137\140\327\310\004\227\316\340\067\001"
	"\070\236\106\112\306\350\346\317\135\260\262\233\322\072\003\276"
	"\227\072\371\230\125\155\353\115\366\077\123\044\167\017\315\156"
	"\354\267\010\342\065\166\252\350\203\003\110\305\335\056\002\224"
	"\266\121\251\366\277\364\110\260\071\146\007\232\132\056\051\013"
	"\113\325\147\262\072\325\120\174\070\016\243\102\357\123\201\021"
	"\230\010\361\330\103\003\041\124\170\277\004\022\162\304\246\027"
	"\211\333\334\133\026\334\321\172\345\201\355\032\262\324\255\002"
	"\373\130\073\206\002\237\376\045\313\247\205\037\331\006\015\123"
	"\063\344\132\213\077\372\034\261\260\263\006\176\252\141\323\303"
	"\104\221\127\276\331\176\231\037\004\144\000\335\043\242\000\250"
	"\172\302\274\200\361\166\305\060\136\251\045\263\156\310\237\277"
	"\376\051\262\053\155\155\232\137\325\016\011\174\062\275\303\032"
	"\215\152\365\322\072\011\232\322\363\216\341\126\044\072\211\120"
	"\156\123\145\134\275\111\114\333\170\311\256\253\104\006\331\320"
	"\356\010\077\157\031\370\077\003\070\171\153\251\221\146\262\111"
	"\213\353\216\342\210\321\004\073\064\353\160\270\161\315\250\015"
	"\363\251\140\136\322\362\220\046\045\265\020\034\146\012\125\150"
	"\342\264\156\074\336\271\333\020\267\001\076\011\062\111\261\277"
	"\060\176\337\157\000\224\171\317\130\262\042\006\331\256\014\202"
	"\153\270\270\046\271\275\261\062\311\030\316\043\223\372\140\122"
	"\375\117\312\006\305\126\230\244\376\337\006\357\216\052\372\371"
	"\135\254\044\070\377\105\000\012\261\023\346\230\320\002\121\307"
	"\332\165\204\171\075\201\130\330\037\377\015\200\225\170\276\043"
	"\334\347\353\225\140\241\240\171\356\037\004\207\255\246\204\173"
	"\064\006\064\205\250\021\250\207\215\361\007\117\060\372\074\011"
	"\364\132\161\037\120\301\005\360\260\265\005\335\264\032\257\052"
	"\331\264\326\204\047\366\265\304\254\355\276\107\237\266\017\015"
	"\131\335\251\220\125\111\065\051\025\330\015\375\254\102\330\365"
	"\365\035\207\203\262\223\007\051\032\036\275\242\272\114\256\066"
	"\317\133\051\143\223\106\332\316\226\136\251\214\332\101\126\110"
	"\001\044\144\046\235\036\243\335\165\003\125\256\310\244\225\344"
	"\212\051\036\000\327\000\007\062\215\330\032\176\214\272\045\172"
	"\352\047\303\133\040\371\330\311\374\107\023\126\166\300\051\301"
	"\127\324\161\374\312\044\303\017\142\014\203\005\250\213\212\006"
	"\242\230\310\207\024\231\304\126\343\057\132\217\346\052\131\266"
	"\030\341\170\274\137\151\246\202\342\122\247\324\131\375\326\155"
	"\371\301\273\142\357\013\221\023\010\025\061\256\362\123\034\340"
	"\102\365\137\167\272\143\312\007\333\252\304\260\052\017\076\141"
	"\377\042\350\103\220\075\104\137\272\147\065\262\101\005\035\207"
	"\064\344\147\044\213\233\372\174\117\360\366\332\053\211\165\017"
	"\327\336\013\226\332\273\112\233\167\365\115\116\225\017\021\000"
	"\270\272\043\310\260\213\321\121\135\124\104\143\004\140\303\341"
	"\266\165\262\054\107\264\307\064\334\365\272\350\232\264\215\025"
	"\316\171\372\022\112\075\204\142\115\111\230\256\230\071\036\040"
	"\251\157\306\320\032\262\100\244\172\043\304\331\167\147\234\311"
	"\041\176\170\342\355\053\226\050\320\302\123\062\330\143\175\363"
	"\317\333\251\264\213\074\152\065\067\005\000\101\102\352\265\064"
	"\234\075\133\353\312\027\125\207\303\307\330\337\220\340\144\077"
	"\325\225\141\165\047\361\035\341\170\242\107\217\044\323\343\251"
	"\333\074\210\000\336\256\070\161\255\107\176\237\206\076\064\361"
	"\012\060\373\010\311\042\341\124\317\274\265\345\031\132\104\335"
	"\235\376\145\077\044\261\123\174\007\013\035\046\026\351\372\272"
	"\051\274\356\021\017\216\063\252\250\007\350\255\134\001\020\241"
	"\143\135\126\137\232\302\256\247\236\166\135\323\372\361\367\310"
	"\316\111\243\317\031\057\135\156\106\255\231\042\006\042\012\142"
	"\177\320\276\015\346\252\143\362\203\212\013\233\173\150\204\007"
	"\007\346\334\140\162\041\072\156\143\142\047\272\232\172\174\147"
	"\311\346\300\306\376\325\231\211\110\352\346\235\215\324\172\255"
	"\013\215\271\140\063\155\364\100\111\117\240\051\262\145\011\166"
	"\344\225\253\052\126\177\334\261\017\165\134\100\202\042\001\001"
	"\325\062\021\274\341\356\263\010\213\302\260\175\331\144\163\065"
	"\321\304\236\165\160\025\006\263\156\202\131\273\075\112\057\315"
	"\077\027\162\321\053\127\257\327\156\216\320\037\371\036\262\340"
	"\255\165\007\217\272\263\234\174\015\264\337\345\140\152\051\355"
	"\024\314\345\234\067\320\326\336\174\271\047\074\361\140\133\074"
	"\003\304\341\134\055\017\247\273\307\365\025\203\322\172\144\153"
	"\012\057\276\042\130\055\366\211\260\016\034\322\251\200\175\344"
	"\377\060\226\016\066\267\211\175\340\263\016\347\340\227\306\371"
	"\152\051\140\236\123\140\361\154\334\300\357\061\034\251\252\270"
	"\035\263\132\246\143\202\011\261\361\135\356\366\020\020\207\222"
	"\347\071\046\231\373\300\240\245\115\255\111\145\343\252\061\220"
	"\240\141\003\034\012\126\331\300\375\175\063\201\104\317\161\176"
	"\012\042\000\015\154\163\165\001\374\070\023\201\015\107\256\300"
	"\163\125\270\317\161\013\201\136\054\076\330\300\070\021\030\241"
	"\173\004\030\277\075\167\360\317\271\220\026\251\237\011\311\050"
	"\355\125\315\252\377\333\012\126\076\346\153\014\217\166\231\250"
	"\105\360\057\115\310\026\327\054\166\320\350\074\376\156\174\052"
	"\256\146\330\064\071\337\056\063\242\031\274\173\212\267\167\242"
	"\366\167\330\312\070\014\071\300\235\063\117\277\001\313\134\231"
	"\132\360\031\375\323\164\344\152\362\157\006\330\032\041\076\105"
	"\040\340\020\270\222\160\045\375\107\105\161\113\064\311\236\254"
	"\166\224\313\253\375\025\035\150\141\053\150\017\070\251\311\356"
	"\100\217\022\244\232\151\175\171\320\126\356\013\025\242\320\234"
	"\143\153\206\007\243\364\057\117\022\335\067\177\070\317\056\226"
	"\253\217\176\247\130\131\103\030\247\200\005\134\033\006\005\253"
	"\110\151\072\327\357\170\033\216\366\001\100\331\363\312\351\303"
	"\112\063\225\264\335\352\345\047\230\221\267\005\052\111\354\167"
	"\330\071\161\300\117\265\126\263\200\102\261\112\037\136\066\361"
	"\173\121\026\266\263\044\367\277\055\142\155\177\052\077\344\114"
	"\042\071\373\017\165\135\124\146\044\100\116\335\017\205\055\103"
	"\332\017\207\301\350\317\055\262\023\230\264\144\352\003\333\072"
	"\342\200\165\065\223\343\165\005\346\222\253\320\157\130\053\324"
	"\332\247\030\314\125\271\002\130\300\261\371\040\173\057\034\056"
	"\372\061\154\112\377\114\226\035\155\356\167\334\360\047\307\277"
	"\130\206\331\311\101\217\217\276\034\273\214\123\221\035\305\251"
	"\160\034\141\157\050\275\121\344\372\354\044\172\300\343\347\100"
	"\045\075\177\164\210\164\243\036\151\270\163\030\263\135\236\155"
	"\255\215\166\355\137\040\065\323\376\167\116\200\346\160\052\154"
	"\333\347\134\221\110\237\317\352\322\067\330\114\130\376\040\032"
	"\334\214\331\151\237\165\033\061\073\373\044\364\352\316\014\320"
	"\131\121\142\210\366\061\344\304\063\132\005\352\034\335\052\022"
	"\336\302\037\054\370\320\340\105\232\141\161\166\362\263\107\317"
	"\141\374\377\114\316\067\147\174\216\002\364\000\337\127\251\202"
	"\162\057\052\056\011\264\170\065\013\316\270\246\316\223\177\142"
	"\224\015\254\362\161\310\222\250\261\134\354\070\304\313\205\343"
	"\237\062\055\317\243\142\214\031\276\135\243\327\133\063\367\004"
	"\344\337\023\213\107\031\123\202\211\320\045\110\240\061\077\357"
	"\025\125\057\221\065\376\235\156\044\336\210\353\064\134\015\040"
	"\347\111\132\064\243\007\172\161\012\071\137\217\264\047\213\121"
	"\122\173\265\150\316\351\316\367\157\125\037\023\374\155\166\166"
	"\352\257\115\013\032\004\324\266\300\024\060\113\314\013\236\036"
	"\114\146\210\131\115\072\344\246\140\361\274\132\333\256\070\217"
	"\122\051\335\205\101\143\235\124\104\271\004\353\243\323\250\351"
	"\035\070\016\320\307\147\130\170\075\046\143\036\074\267\331\055"
	"\151\253\256\120\254\257\361\056\104\373\142\351\242\200\120\202"
	"\242\142\330\002\251\145\351\356\103\273\132\376\015\067\020\127"
	"\001\010\103\170\274\131\055\276\341\075\365\056\014\246\175\107"
	"\264\077\345\342\365\220\141\355\016\076\306\163\342\340\267\373"
	"\243\311\134\366\365\234\320\063\036\356\041\222\211\056\376\140"
	"\207\067\372\135\313\343\133\317\322\321\316\264\051\205\025\347"
	"\216\161\052\310\056\301\357\116\273\202\216\377\040\111\160\043"
	"\056\161\205\152\325\247\057\224\277\375\330\132\062\373\316\302"
	"\271\156\353\325\312\121\031\254\252\302\153\036\106\377\020\213"
	"\173\057\206\360\356\213\351\272\340\105\367\131\224\066\233\303"
	"\352\055\337\335\142\122\051\070\022\155\001\370\152\204\033\227"
	"\244\134\234\317\053\143\155\337\356\276\332\327\324\234\347\206"
	"\127\023\237\231\132\326\013\013\157\163\232\303\347\004\117\215"
	"\212\022\200\170\120\063\214\203\115\030\233\063\033\346\066\102"
	"\055\045\162\062\370\236\332\055\265\167\037\255\177\041\043\267"
	"\236\355\111\217\312\331\365\014\015\102\051\101\147\072\352\161"
	"\343\047\264\052\153\207\160\065\075\021\152\337\055\367\315\075"
	"\050\324\026\010\137\216\301\164\260\066\341\102\310\361\036\002"
	"\220\235\036\137\035\213\327\050\362\154\054\005\333\354\043\221"
	"\346\146\320\137\344\336\110\174\235\212\277\160\345\115\372\373"
	"\336\035\173\120\356\346\055\206\044\055\371\251\173\237\313\321"
	"\356\067\316\023\026\014\323\031\075\273\361\030\105\217\046\260"
	"\341\244\351\274\103\110\000\100\151\200\310\127\354\277\247\046"
	"\126\200\015\010\364\346\261\145\035\051\116\022\322\034\064\312"
	"\301\027\011\155\157\323\057\146\124\243\331\373\055\245\063\224"
	"\005\244\211\231\204\003\074\142\034\343\106\210\311\367\121\077"
	"\271\165\367\151\370\302\125\174\254\126\205\252\343\223\356\334"
	"\225\053\272\344\355\131\230\277\055\206\076\213\233\014\074\244"
	"\077\237\047\067\161\175\325\121\225\026\353\075\060\010\367\165"
	"\276\235\222\346\035\132\210\072\145\222\033\353\365\164\323\374"
	"\063\326\366\253\130\361\201\335\333\237\137\131\034\104\265\264"
	"\003\340\104\206\020\205\101\166\202\214\142\210\051\013\101\362"
	"\151\242\220\014\133\146\031\030\105\173\311\156\344\225\276\103"
	"\373\316\310\070\076\022\003\213\102\007\021\065\063\113\156\332"
	"\120\351\122\035\366\202\003\240\271\264\266\264\322\140\334\257"
	"\260\261\112\306\244\007\145\037\326\313\111\164\277\365\230\320"
	"\037\352\353\332\022\353\203\320\142\027\126\003\176\055\205\205"
	"\341\047\274\241\325\255\244\150\355\214\256\150\235\121\166\077"
	"\104\250\135\352\035\152\330\133\060\154\001\332\150\135\100\172"
	"\254\272\053\307\027\237\124\062\163\201\357\337\376\324\375\153"
	"\072\141\173\211\376\121\022\021\371\233\023\253\147\120\043\076"
	"\225\206\206\101\032\061\233\250\022\342\274\230\112\343\057\116"
	"\007\166\355\134\331\142\052\361\237\306\142\366\366\322\024\016"
	"\164\354\267\051\030\022\222\360\360\160\075\124\067\234\153\231"
	"\064\266\363\321\041\164\032\254\055\353\205\236\003\306\364\165"
	"\067\217\166\044\101\110\045\071\322\221\252\127\253\023\246\343"
	"\052\032\071\032\076\013\306\323\147\346\011\034\152\122\013\035"
	"\367\027\222\335\047\144\011\366\024\056\014\140\115\101\241\077"
	"\324\203\066\225\205\272\062\313\012\260\166\001\016\363\015\031"
	"\241\151\174\153\344\042\066\056\242\221\161\122\257\342\310\146"
	"\273\262\161\356\101\001\243\340\251\057\260\004\012\301\232\025"
	"\366\014\110\326\274\322\122\302\235\032\244\234\042\300\004\241"
	"\263\135\103\164\254\120\002\077\207\151\241\024\353\026\042\211"
	"\327\360\233\225\165\252\341\372\135\364\246\142\147\152\132\011"
	"\070\312\032\131\065\072\273\263\076\243\321\274\231\022\164\263"
	"\261\367\027\035\207\333\160\363\341\303\303\323\047\041\136\227"
	"\000\320\152\227\121\073\221\064\330\313\120\321\211\131\112\253"
	"\306\371\130\204\040\020\251\371\070\153\126\361\271\272\362\361"
	"\326\146\160\237\202\220\206\010\064\100\243\176\273\157\312\163"
	"\204\362\173\220\153\310\067\131\245\332\077\314\172\332\215\050"
	"\265\155\363\116\130\227\040\273\270\116\365\152\171\222\373\310"
	"\320\271\051\312\033\110\102\241\361\103\067\107\123\024\005\120"
	"\375\051\025\300\206\162\300\124\351\150\120\346\177\135\323\330"
	"\352\123\007\375\343\173\024\116\061\352\037\042\354\115\337\111"
	"\315\133\354\206\327\230\136\051\243\343\156\236\015\025\124\167"
	"\362\111\235\251\362\313\201\163\264\336\016\053\131\172\366\106"
	"\165\222\162\307\007\022\273\134\327\346\242\005\313\022\365\227"
	"\371\375\027\046\313\333\303\067\226\226\335\044\011\111\244\167"
	"\300\007\300\222\145\016\073\010\300\355\164\356\275\031\376\076"
	"\001\051\224\045\337\364\074\374\303\126\274\007\221\020\105\167"
	"\137\262\060\115\300\350\206\104\223\110\037\333\107\124\100\030"
	"\353\317\207\366\136\031\115\030\042\336\232\274\156\100\172\256"
	"\354\172\152\256\357\306\257\216\050\266\175\315\054\364\061\101"
	"\055\004\267\316\055\143\131\276\222\361\022\262\172\056\102\110"
	"\201\037\267\351\125\302\325\014\173\056\354\045\377\071\066\164"
	"\007\250\225\360\021\363\075\061\045\177\273\065\151\022\175\353"
	"\061\065\325\207\370\252\223\163\331\177\231\331\271\317\115\300"
	"\170\343\261\211\326\357\273\373\157\166\061\330\210\256\304\272"
	"\344\231\101\334\104\325\120\035\124\351\367\016\271\105\317\061"
	"\050\201\272\376\160\166\372\337\354\053\270\165\332\174\060\276"
	"\026\161\232\132\106\352\170\233\324\157\252\215\264\172\276\334"
	"\373\171\333\154\357\325\113\334\000\004\122\332\201\202\230\227"
	"\364\063\361\072\035\151\326\362\331\200\177\215\373\076\152\366"
	"\270\106\142\250\033\256\205\034\262\327\366\064\131\217\313\115"
	"\302\274\210\340\046\136\322\377\337\122\215\332\221\370\321\111"
	"\076\063\362\132\342\167\166\224\117\155\310\250\374\224\366\277"
	"\121\177\237\167\336\162\167\275\305\005\230\126\375\151\240\074"
	"\235\222\227\177\012\016\024\131\173\335\002\170\161\371\070\303"
	"\170\330\072\126\112\262\024\017\267\255\146\265\027\006\362\264"
	"\231\211\064\243\230\110\374\023\046\376\214\230\367\304\133\160"
	"\234\226\306\347\110\333\367\000\211\135\265\240\144\247\125\375"
	"\061\211\240\311\322\234\335\370\233\152\220\223\057\354\003\313"
	"\202\312\263\313\246\252\313\057\010\200\317\154\050\044\151\132"
	"\256\011\044\200\246\002\171\101\154\012\325\234\366\331\150\170"
	"\243\033\103\112\305\016\171\315\217\111\071\270\155\243\022\033"
	"\254\067\234\122\071\025\224\246\037\152\103\025\103\253\216\346"
	"\306\322\060\214\340\252\132\160\363\224\050\141\067\073\175\343"
	"\163\031\066\255\057\313\123\116\066\227\144\171\102\362\140\010"
	"\305\221\224\245\073\357\026\056\203\077\217\272\173\014\236\356"
	"\046\325\233\125\241\357\243\327\206\010\120\310\373\260\321\300"
	"\101\146\146\175\125\174\253\330\273\073\223\066\110\062\045\156"
	"\007\300\303\251\257\147\201\066\160\321\376\153\202\317\054\304"
	"\066\222\101\213\017\355\144\312\051\367\001\161\052\046\340\061"
	"\347\244\333\226\014\134\315\174\056\313\350\260\233\024\165\321"
	"\247\267\135\266\244\301\200\316\270\202\100\342\251\040\024\220"
	"\304\360\047\321\114\364\116\173\300\066\054\133\113\241\055\362"
	"\130\212\250\375\113\051\313\004\253\013\347\125\054\374\345\361"
	"\355\015\302\072\002\020\265\302\107\341\036\222\202\114\204\333"
	"\326\055\331\042\126\245\047\002\261\017\127\335\014\075\316\371"
	"\112\221\064\114\242\351\017\351\312\055\174\115\171\000\051\120"
	"\055\002\162\204\247\232\206\130\252\335\066\266\032\005\260\145"
	"\227\344\261\071\316\300\042\231\356\236\346\147\237\020\270"
#define      tst2_z	19
#define      tst2	((&data[8181]))
	"\004\006\076\150\124\055\325\107\322\077\022\110\375\066\320\307"
	"\247\343\215"
#define      inlo_z	3
#define      inlo	((&data[8200]))
	"\357\372\245"
#define      date_z	1
#define      date	((&data[8203]))
	"\167"
#define      rlax_z	1
#define      rlax	((&data[8204]))
	"\024"
#define      shll_z	10
#define      shll	((&data[8205]))
	"\205\130\233\245\137\125\321\002\177\154\064\346"
#define      opts_z	1
#define      opts	((&data[8217]))
	"\353"
#define      chk1_z	22
#define      chk1	((&data[8221]))
	"\043\226\341\103\115\107\105\262\137\230\034\212\026\022\243\156"
	"\353\312\212\155\252\005\320\061\020\012"
#define      xecc_z	15
#define      xecc	((&data[8246]))
	"\266\117\060\025\175\336\226\112\146\047\253\301\141\015\003\365"
	"\203"
#define      tst1_z	22
#define      tst1	((&data[8266]))
	"\347\247\170\373\027\140\300\026\361\237\310\146\022\121\346\010"
	"\146\345\361\212\045\273\116\161\153\021\243\055\105\075"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
